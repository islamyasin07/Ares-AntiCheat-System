<div class="report-container">
  <div class="report-header">
    <h2>Analytics Report</h2>
    <p>Batch analytics (Spark CSV) and summaries</p>
    <button class="refresh-btn" (click)="refresh()">Refresh</button>
  </div>

  <div *ngIf="loading" class="loading">Loading analytics...</div>

  <div *ngIf="!loading">
    <section class="cards">
      <div class="card">
        <h3>Top Cheaters</h3>
        <div *ngIf="topCheaters.length === 0">No top cheaters data available.</div>
        <ul *ngIf="topCheaters.length > 0" class="top-list">
          <li *ngFor="let p of topCheaters">
            <div class="player">{{ p.player_id || p.playerId || 'player' }}</div>
            <div class="meta">Events: <strong>{{ p.count || 0 }}</strong> â€¢ AvgProb: <strong>{{ (p.avg_prob || 0) | number:'1.0-2' }}</strong></div>
          </li>
        </ul>
      </div>

      <div class="card">
        <h3>Cheat Distribution</h3>
        <div *ngIf="distData.length === 0">No distribution data available.</div>
        <div *ngIf="distData.length > 0">
          <app-ares-pie-chart [labels]="distLabels" [data]="distData"></app-ares-pie-chart>
        </div>
      </div>

      <div class="card wide">
        <h3>Hourly Events (last 24h)</h3>
        <div *ngIf="hourlyData.length === 0">No hourly data.</div>
        <div *ngIf="hourlyData.length > 0">
          <app-ares-line-chart [labels]="hourlyLabels" [data]="hourlyData"></app-ares-line-chart>
        </div>
      </div>

      <div class="card wide">
        <h3>Avg Movement Speed (last 24h)</h3>
        <div *ngIf="speedData.length === 0">No speed data.</div>
        <div *ngIf="speedData.length > 0">
          <app-ares-line-chart [labels]="speedLabels" [data]="speedData"></app-ares-line-chart>
        </div>
      </div>
    </section>
  </div>
</div>
