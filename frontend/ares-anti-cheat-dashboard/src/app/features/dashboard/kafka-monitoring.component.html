<div class="space-y-4">
  <!-- Error Message -->
  <div *ngIf="error" class="p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-red-400">
    {{ error }}
  </div>

  <!-- Top Stats -->
  <div class="grid grid-cols-2 lg:grid-cols-3 gap-3">
    <app-stat-card title="Total Topics" [value]="totalTopics" color="neonBlue"></app-stat-card>
    <app-stat-card title="Total Partitions" [value]="totalPartitions" color="neonPink"></app-stat-card>
    <app-stat-card title="Total Lag" [value]="totalLag" color="neonPurple"></app-stat-card>
  </div>

  <!-- Topics List -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-3">
    <!-- Topics Panel -->
    <app-glow-card class="h-[500px] overflow-hidden flex flex-col">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-sm font-orbitron text-neonBlue">Kafka Topics</h2>
        <button 
          (click)="loadTopics()"
          [disabled]="loading"
          class="px-3 py-1 text-xs bg-neonBlue/20 hover:bg-neonBlue/40 text-neonBlue rounded border border-neonBlue/50 transition-all"
        >
          {{ loading ? 'Loading...' : 'Refresh' }}
        </button>
      </div>

      <div class="overflow-y-auto flex-1 space-y-2">
        <div *ngIf="topics.length === 0" class="text-gray-400 text-sm text-center py-8">
          No topics found
        </div>
        <button
          *ngFor="let topic of topics"
          (click)="selectTopic(topic.name)"
          [class.selected]="selectedTopic?.name === topic.name"
          class="w-full text-left px-3 py-2 rounded border border-neonBlue/20 hover:border-neonBlue/50 hover:bg-neonBlue/10 transition-all text-sm text-gray-300 truncate"
          [style.background]="selectedTopic?.name === topic.name ? 'rgba(59, 199, 255, 0.2)' : 'transparent'"
        >
          {{ topic.name }}
        </button>
      </div>
    </app-glow-card>

    <!-- Topic Details Panel -->
    <app-glow-card class="lg:col-span-2 h-[500px] overflow-hidden flex flex-col">
      <div *ngIf="!selectedTopic" class="flex items-center justify-center h-full text-gray-400">
        <div class="text-center">
          <p class="text-lg mb-2">Select a topic to view details</p>
          <p class="text-xs text-gray-500">Click on any topic from the list</p>
        </div>
      </div>

      <div *ngIf="selectedTopic" class="flex flex-col h-full">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-sm font-orbitron text-neonPink">{{ selectedTopic.name }}</h2>
          <button 
            (click)="refreshTopicDetails()"
            [disabled]="loading"
            class="px-3 py-1 text-xs bg-neonPink/20 hover:bg-neonPink/40 text-neonPink rounded border border-neonPink/50 transition-all"
          >
            {{ loading ? 'Loading...' : 'Refresh' }}
          </button>
        </div>

        <div class="overflow-y-auto flex-1">
          <table class="w-full text-sm">
            <thead class="sticky top-0 bg-slate-900/50 backdrop-blur">
              <tr class="border-b border-neonBlue/20">
                <th class="text-left py-2 px-2 text-neonBlue font-orbitron">Partition</th>
                <th class="text-right py-2 px-2 text-neonBlue font-orbitron">Earliest</th>
                <th class="text-right py-2 px-2 text-neonBlue font-orbitron">Latest</th>
                <th class="text-right py-2 px-2 text-neonBlue font-orbitron">Lag</th>
                <th class="text-center py-2 px-2 text-neonBlue font-orbitron">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr 
                *ngFor="let partition of selectedTopic.partitions"
                class="border-b border-gray-700/30 hover:bg-gray-700/20 transition-colors"
              >
                <td class="py-2 px-2 text-gray-300">{{ partition.partition }}</td>
                <td class="py-2 px-2 text-right text-gray-400">{{ partition.earliestOffset }}</td>
                <td class="py-2 px-2 text-right text-gray-400">{{ partition.latestOffset }}</td>
                <td class="py-2 px-2 text-right font-semibold" 
                    [ngClass]="getLagStatus(partition.lag) === 'healthy' ? 'text-green-400' : 
                              getLagStatus(partition.lag) === 'warning' ? 'text-yellow-400' : 'text-red-400'">
                  {{ partition.lag }}
                </td>
                <td class="py-2 px-2 text-center">
                  <span class="inline-block px-2 py-1 rounded text-xs font-semibold"
                        [ngClass]="getLagStatus(partition.lag) === 'healthy' ? 'bg-green-500/20 text-green-400' : 
                                  getLagStatus(partition.lag) === 'warning' ? 'bg-yellow-500/20 text-yellow-400' : 'bg-red-500/20 text-red-400'">
                    {{ getLagStatus(partition.lag) | uppercase }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Summary Stats -->
        <div class="mt-4 pt-4 border-t border-gray-700/30 grid grid-cols-3 gap-3">
          <div class="text-center">
            <p class="text-xs text-gray-500">Total Partitions</p>
            <p class="text-lg font-orbitron text-neonBlue">{{ selectedTopic.partitions.length }}</p>
          </div>
          <div class="text-center">
            <p class="text-xs text-gray-500">Total Lag</p>
            <p class="text-lg font-orbitron text-neonPink">{{ totalLag }}</p>
          </div>
          <div class="text-center">
            <p class="text-xs text-gray-500">Avg Lag/Partition</p>
            <p class="text-lg font-orbitron text-neonPurple">{{ (totalLag / selectedTopic.partitions.length) | number:'1.0-0' }}</p>
          </div>
        </div>
      </div>
    </app-glow-card>
  </div>
</div>
